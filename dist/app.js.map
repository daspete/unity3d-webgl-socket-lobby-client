{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/WebSocketLobby/WebSocketLobby.js","src/app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","WebSocketLobby","_classCallCheck","this","unityWebSocketLobbyGameObject","config","socket","roomSocket","connectionTimeout","currentConnectionTimeout","connectionID","gameServerUrl","functionName","parameter","SendMessage","data","JSON","parse","server","socketIOScript","document","createElement","setAttribute","head","appendChild","SocketIOCheck","io","Send","setTimeout","bind","ConnectToGameServer","connect","on","OnConnected","OnDisconnected","OnConnectedToRoom","GetRoomList","GetPlayerList","OnGameStarted","OnRoomReady","roomName","emit","OnRoomCreated","stringify","roomID","OnRoomJoined","OnLeftRoom","OnGotRoomList","OnGotPlayerList","updateData","OnGotConnectionID","JoinLobby","_WebSocketLobby","window","webglSocketLobby","_WebSocketLobby2","default"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class WebSocketLobby {\r\n\r\n    constructor(){\r\n        this.unityWebSocketLobbyGameObject = 'WebGLSocketLobby';\r\n        this.config = {};\r\n\r\n        this.socket = null;\r\n        this.roomSocket = null;\r\n        this.connectionTimeout = 10;\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        this.connectionID = '';\r\n\r\n        this.gameServerUrl = '';\r\n    }\r\n\r\n    Send(functionName, parameter){\r\n        SendMessage(this.unityWebSocketLobbyGameObject, functionName, parameter);\r\n    }\r\n\r\n    SetConfig(data){\r\n        this.config = JSON.parse(data);\r\n    }\r\n\r\n    Connect(server){\r\n        this.gameServerUrl = 'http://' + server + '/';\r\n\r\n        var socketIOScript = document.createElement('script');\r\n        socketIOScript.setAttribute('src', this.gameServerUrl + 'socket.io/socket.io.js');\r\n        document.head.appendChild(socketIOScript);\r\n\r\n        this.SocketIOCheck();\r\n    }\r\n\r\n    SocketIOCheck(){\r\n        if(typeof io == 'undefined'){\r\n            this.currentConnectionTimeout++;\r\n\r\n            this.currentConnectionTimeout == this.connectionTimeout\r\n                ? this.Send('SocketConnectionTimeout')\r\n                : setTimeout(this.SocketIOCheck.bind(this), 1000);\r\n\r\n            return;\r\n        }\r\n\r\n        this.ConnectToGameServer();\r\n    }\r\n\r\n    ConnectToGameServer(){\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        //var url = this.GetConnectionUrl(this.gameServerUrl);\r\n\r\n        //this.socket = io.connect(url.url, {path: url.path});\r\n        this.socket = io.connect(this.gameServerUrl);\r\n\r\n        this.socket.on('connect', this.OnConnected.bind(this));\r\n        this.socket.on('disconnect', this.OnDisconnected.bind(this));\r\n    }\r\n\r\n    /*GetConnectionUrl(origUrl){\r\n        var urlSplit = origUrl.replace('http://', '').split('/');\r\n        var url = origUrl;\r\n        var path = '/socket.io';\r\n\r\n        if(urlSplit.length > 1){\r\n            url = 'http://' + urlSplit[0];\r\n            path = '/';\r\n\r\n            for(var i = 1; i < urlSplit.length; i++){\r\n                if(urlSplit[i] != '')\r\n                    path += urlSplit[i] + '/';\r\n            }\r\n\r\n            path += 'socket.io';\r\n        }\r\n\r\n        return {\r\n            url: url,\r\n            path: path\r\n        };\r\n    }*/\r\n\r\n    JoinLobby(){\r\n        //var url = this.GetConnectionUrl(this.gameServerUrl);\r\n\r\n        //this.roomSocket = io.connect(url.url + 'rooms', { path: url.path });\r\n        this.roomSocket = io.connect(this.gameServerUrl + 'rooms');\r\n        this.roomSocket.on('connect', this.OnConnectedToRoom.bind(this));\r\n\r\n        this.roomSocket.on('get-room-list', this.GetRoomList.bind(this));\r\n        this.roomSocket.on('get-player-list', this.GetPlayerList.bind(this));\r\n        this.roomSocket.on('start-game', this.OnGameStarted.bind(this));\r\n        this.roomSocket.on('room-is-ready', this.OnRoomReady.bind(this));\r\n    }\r\n\r\n    CreateRoom(roomName){\r\n        this.roomSocket.emit('create-room', { roomName: roomName }, this.OnRoomCreated.bind(this));\r\n    }\r\n\r\n    OnRoomCreated(data){\r\n        this.Send('SocketRoomCreated', JSON.stringify(data));\r\n    }\r\n\r\n    JoinRoom(roomID){\r\n        this.roomSocket.emit('join-room', { roomID: roomID }, this.OnRoomJoined.bind(this));\r\n    }\r\n\r\n    OnRoomJoined(data){\r\n        this.Send('SocketRoomJoined', JSON.stringify(data));\r\n    }\r\n\r\n    LeaveRoom(roomID){\r\n        this.roomSocket.emit('leave-room', { roomID: roomID }, this.OnLeftRoom.bind(this));\r\n    }\r\n\r\n    OnLeftRoom(){\r\n        this.Send('SocketLeftRoom');\r\n    }\r\n\r\n    GetRoomList(){\r\n        this.roomSocket.emit('get-room-list', this.OnGotRoomList.bind(this));\r\n    }\r\n\r\n    OnGotRoomList(data){\r\n        this.Send('SocketGotRoomList', JSON.stringify(data));\r\n    }\r\n\r\n    GetPlayerList(roomID){\r\n        this.roomSocket.emit('get-player-list', { roomID: roomID }, this.OnGotPlayerList.bind(this));\r\n    }\r\n\r\n    OnGotPlayerList(data){\r\n        this.Send('SocketGotPlayerList', JSON.stringify(data));\r\n    }\r\n\r\n    UpdatePlayer(data){\r\n        this.roomSocket.emit('update-player', { updateData: data });\r\n    }\r\n\r\n    OnRoomReady(){\r\n        this.Send(\"SocketRoomReady\");\r\n    }\r\n\r\n    StartGame(roomID){\r\n        this.roomSocket.emit('start-game', { roomID: roomID}, this.OnGameStarted.bind(this));\r\n    }\r\n\r\n    OnGameStarted(){\r\n        this.Send(\"SocketStartedGame\");\r\n    }\r\n\r\n    OnConnected(){\r\n        this.socket.emit('set-config', { config: this.config });\r\n        this.socket.emit('get-connection-id', this.OnGotConnectionID.bind(this));\r\n    }\r\n\r\n    OnGotConnectionID(connectionID){\r\n        this.connectionID = connectionID;\r\n        this.JoinLobby();\r\n    }\r\n\r\n    OnDisconnected(){\r\n        this.Send('SocketDisconnected');\r\n    }\r\n\r\n    OnConnectedToRoom(){\r\n        this.Send('SocketConnected', this.connectionID);\r\n    }\r\n\r\n}\r\n\r\nexport default WebSocketLobby;","import WebSocketLobby from './WebSocketLobby/WebSocketLobby.js';\r\n\r\nwindow.webglSocketLobby = new WebSocketLobby();\r\n\r\n"]}