{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/Game/GameClient.js","src/Game/MyGameClient.js","src/WebSocketLobby/WebSocketLobby.js","src/app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","GameClient","_classCallCheck","this","socket","roomID","playerID","unityGameReceiverObject","window","gameClient","data","StartClient","functionName","parameter","SendMessage","_GameClient2","MyGameClient","on","OnSetGoalPosition","bind","OnPlayerWonRound","OnPlayerLostRound","emit","SendToGame","JSON","stringify","WebSocketLobby","unityWebSocketLobbyGameObject","config","roomSocket","connectionTimeout","currentConnectionTimeout","connectionID","gameServerUrl","parse","server","socketIOScript","document","createElement","setAttribute","head","appendChild","SocketIOCheck","io","Send","setTimeout","ConnectToGameServer","connect","OnConnected","OnDisconnected","OnConnectedToRoom","GetRoomList","GetPlayerList","OnGameStarted","OnRoomReady","roomName","OnRoomCreated","OnRoomJoined","OnLeftRoom","OnGotRoomList","OnGotPlayerList","updateData","SetPlayerID","StartReceiver","OnGotConnectionID","JoinLobby","_WebSocketLobby","_MyGameClient","webglSocketLobby","_WebSocketLobby2","default","_MyGameClient2"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class GameClient {\r\n\r\n    constructor(){\r\n        this.socket = null;\r\n        this.roomID = null;\r\n        this.playerID = null;\r\n\r\n        this.unityGameReceiverObject = 'GameManager';\r\n\r\n        window.gameClient = this;\r\n    }\r\n\r\n    SetPlayerID(playerID){\r\n        this.playerID = playerID;\r\n    }\r\n\r\n    StartReceiver(data){\r\n        this.socket = data.socket;\r\n        this.roomID = data.roomID;\r\n\r\n        this.StartClient();\r\n    }\r\n\r\n    StartClient(){}\r\n\r\n    SendToGame(functionName, parameter){\r\n        SendMessage(this.unityGameReceiverObject, functionName, parameter);\r\n    }\r\n\r\n}\r\n\r\nexport default GameClient;","import GameClient from './GameClient.js';\r\n\r\nclass MyGameClient extends GameClient {\r\n\r\n    StartClient(){\r\n        this.socket.on('set-goal-position', this.OnSetGoalPosition.bind(this));\r\n        this.socket.on('player-won-round', this.OnPlayerWonRound.bind(this));\r\n        this.socket.on('player-lost-round', this.OnPlayerLostRound.bind(this));\r\n    }\r\n\r\n    SendPlayerClick(data){\r\n        this.socket.emit('player-got-position', data);\r\n    }\r\n\r\n    OnSetGoalPosition(data){\r\n        this.SendToGame('SocketSetGoalPosition', JSON.stringify(data));\r\n    }\r\n\r\n    OnPlayerWonRound(){\r\n        this.SendToGame('SocketPlayerWonRound');\r\n    }\r\n\r\n    OnPlayerLostRound(){\r\n        this.SendToGame('SocketPlayerLostRound');\r\n    }\r\n\r\n}\r\n\r\nexport default MyGameClient;","class WebSocketLobby {\r\n\r\n    constructor(gameClient){\r\n        this.unityWebSocketLobbyGameObject = 'WebGLSocketLobby';\r\n        this.config = {};\r\n\r\n        this.socket = null;\r\n        this.roomSocket = null;\r\n        this.connectionTimeout = 10;\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        this.connectionID = '';\r\n        this.roomID = null;\r\n\r\n        this.gameServerUrl = '';\r\n\r\n        this.gameClient = gameClient;\r\n    }\r\n\r\n    Send(functionName, parameter){\r\n        SendMessage(this.unityWebSocketLobbyGameObject, functionName, parameter);\r\n    }\r\n\r\n    SetConfig(data){\r\n        this.config = JSON.parse(data);\r\n    }\r\n\r\n    Connect(server){\r\n        this.gameServerUrl = 'http://' + server + '/';\r\n\r\n        var socketIOScript = document.createElement('script');\r\n        socketIOScript.setAttribute('src', this.gameServerUrl + 'socket.io/socket.io.js');\r\n        document.head.appendChild(socketIOScript);\r\n\r\n        this.SocketIOCheck();\r\n    }\r\n\r\n    SocketIOCheck(){\r\n        if(typeof io == 'undefined'){\r\n            this.currentConnectionTimeout++;\r\n\r\n            this.currentConnectionTimeout == this.connectionTimeout\r\n                ? this.Send('SocketConnectionTimeout')\r\n                : setTimeout(this.SocketIOCheck.bind(this), 1000);\r\n\r\n            return;\r\n        }\r\n\r\n        this.ConnectToGameServer();\r\n    }\r\n\r\n    ConnectToGameServer(){\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        this.socket = io.connect(this.gameServerUrl);\r\n\r\n        this.socket.on('connect', this.OnConnected.bind(this));\r\n        this.socket.on('disconnect', this.OnDisconnected.bind(this));\r\n    }\r\n\r\n    JoinLobby(){\r\n        this.roomSocket = io.connect(this.gameServerUrl + 'rooms');\r\n        this.roomSocket.on('connect', this.OnConnectedToRoom.bind(this));\r\n\r\n        this.roomSocket.on('get-room-list', this.GetRoomList.bind(this));\r\n        this.roomSocket.on('get-player-list', this.GetPlayerList.bind(this));\r\n        this.roomSocket.on('start-game', this.OnGameStarted.bind(this));\r\n        this.roomSocket.on('room-is-ready', this.OnRoomReady.bind(this));\r\n    }\r\n\r\n    CreateRoom(roomName){\r\n        this.roomSocket.emit('create-room', { roomName: roomName }, this.OnRoomCreated.bind(this));\r\n    }\r\n\r\n    OnRoomCreated(data){\r\n        this.Send('SocketRoomCreated', JSON.stringify(data));\r\n    }\r\n\r\n    JoinRoom(roomID){\r\n        this.roomSocket.emit('join-room', { roomID: roomID }, this.OnRoomJoined.bind(this));\r\n    }\r\n\r\n    OnRoomJoined(data){\r\n        this.Send('SocketRoomJoined', JSON.stringify(data));\r\n    }\r\n\r\n    LeaveRoom(roomID){\r\n        this.roomSocket.emit('leave-room', { roomID: roomID }, this.OnLeftRoom.bind(this));\r\n    }\r\n\r\n    OnLeftRoom(){\r\n        this.Send('SocketLeftRoom');\r\n    }\r\n\r\n    GetRoomList(){\r\n        this.roomSocket.emit('get-room-list', this.OnGotRoomList.bind(this));\r\n    }\r\n\r\n    OnGotRoomList(data){\r\n        this.Send('SocketGotRoomList', JSON.stringify(data));\r\n    }\r\n\r\n    GetPlayerList(roomID){\r\n        this.roomSocket.emit('get-player-list', { roomID: roomID }, this.OnGotPlayerList.bind(this));\r\n    }\r\n\r\n    OnGotPlayerList(data){\r\n        this.Send('SocketGotPlayerList', JSON.stringify(data));\r\n    }\r\n\r\n    UpdatePlayer(data){\r\n        this.roomSocket.emit('update-player', { updateData: data });\r\n    }\r\n\r\n    OnRoomReady(){\r\n        this.Send('SocketRoomReady');\r\n    }\r\n\r\n    StartGame(roomID){\r\n        this.roomID = roomID;\r\n        this.roomSocket.emit('start-game', { roomID: roomID}, this.OnGameStarted.bind(this));\r\n    }\r\n\r\n    OnGameStarted(){\r\n        this.gameClient.SetPlayerID(this.connectionID);\r\n        this.gameClient.StartReceiver({\r\n            socket: this.roomSocket,\r\n            roomID: this.roomID\r\n        });\r\n\r\n        this.Send('SocketStartedGame');\r\n    }\r\n\r\n    OnConnected(){\r\n        this.socket.emit('set-config', { config: this.config });\r\n        this.socket.emit('get-connection-id', this.OnGotConnectionID.bind(this));\r\n    }\r\n\r\n    OnGotConnectionID(connectionID){\r\n        this.connectionID = connectionID;\r\n        this.JoinLobby();\r\n    }\r\n\r\n    OnDisconnected(){\r\n        this.roomID = null;\r\n        this.Send('SocketDisconnected');\r\n    }\r\n\r\n    OnConnectedToRoom(){\r\n        this.Send('SocketConnected', this.connectionID);\r\n    }\r\n\r\n}\r\n\r\nexport default WebSocketLobby;","import WebSocketLobby from './WebSocketLobby/WebSocketLobby.js';\r\nimport MyGameClient from './Game/MyGameClient.js';\r\n\r\n\r\nwindow.webglSocketLobby = new WebSocketLobby(new MyGameClient());\r\n\r\n"]}