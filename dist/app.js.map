{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/Game/GameClient.js","src/Game/MyGameClient.js","src/WebSocketLobby/WebSocketLobby.js","src/app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","GameClient","_classCallCheck","this","socket","roomID","unityGameReceiverObject","window","gameClient","data","on","OnReceiveGameData","bind","StartClient","SendToGame","emit","functionName","parameter","SendMessage","_GameClient2","MyGameClient","OnSetGoalPosition","JSON","stringify","WebSocketLobby","unityWebSocketLobbyGameObject","config","roomSocket","connectionTimeout","currentConnectionTimeout","connectionID","gameServerUrl","parse","server","socketIOScript","document","createElement","setAttribute","head","appendChild","SocketIOCheck","io","Send","setTimeout","ConnectToGameServer","connect","OnConnected","OnDisconnected","OnConnectedToRoom","GetRoomList","GetPlayerList","OnGameStarted","OnRoomReady","roomName","OnRoomCreated","OnRoomJoined","OnLeftRoom","OnGotRoomList","OnGotPlayerList","updateData","StartReceiver","OnGotConnectionID","JoinLobby","_WebSocketLobby","_MyGameClient","webglSocketLobby","_WebSocketLobby2","default","_MyGameClient2"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class GameClient {\r\n\r\n    constructor(){\r\n        this.socket = null;\r\n        this.roomID = null;\r\n\r\n        this.unityGameReceiverObject = 'GameManager';\r\n\r\n        window.gameClient = this;\r\n    }\r\n\r\n    StartReceiver(data){\r\n        this.socket = data.socket;\r\n        this.roomID = data.roomID;\r\n\r\n        this.socket.on('receive-game-data', this.OnReceiveGameData.bind(this));\r\n\r\n        this.StartClient();\r\n    }\r\n\r\n    StartClient(){}\r\n\r\n    OnReceiveGameData(data){\r\n        this.SendToGame('SocketReceiveData', data);\r\n    }\r\n\r\n    SendToAllPlayers(data){\r\n        this.socket.emit('send-to-all-players', data);\r\n    }\r\n\r\n    SendToOnePlayer(data){\r\n        this.socket.emit('send-to-one-player', data);\r\n    }\r\n\r\n    SendToServer(data){\r\n        this.socket.emit('send-to-server', data);\r\n    }\r\n\r\n    SendToGame(functionName, parameter){\r\n        SendMessage(this.unityGameReceiverObject, functionName, parameter);\r\n    }\r\n\r\n}\r\n\r\nexport default GameClient;","import GameClient from './GameClient.js';\r\n\r\nclass MyGameClient extends GameClient {\r\n\r\n    StartClient(){\r\n        this.socket.on('set-goal-position', this.OnSetGoalPosition.bind(this));\r\n    }\r\n\r\n    OnSetGoalPosition(data){\r\n        this.SendToGame('SocketSetGoalPosition', JSON.stringify(data));\r\n    }\r\n\r\n}\r\n\r\nexport default MyGameClient;","class WebSocketLobby {\r\n\r\n    constructor(gameClient){\r\n        this.unityWebSocketLobbyGameObject = 'WebGLSocketLobby';\r\n        this.config = {};\r\n\r\n        this.socket = null;\r\n        this.roomSocket = null;\r\n        this.connectionTimeout = 10;\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        this.connectionID = '';\r\n        this.roomID = null;\r\n\r\n        this.gameServerUrl = '';\r\n\r\n        this.gameClient = gameClient;\r\n    }\r\n\r\n    Send(functionName, parameter){\r\n        SendMessage(this.unityWebSocketLobbyGameObject, functionName, parameter);\r\n    }\r\n\r\n    SetConfig(data){\r\n        this.config = JSON.parse(data);\r\n    }\r\n\r\n    Connect(server){\r\n        this.gameServerUrl = 'http://' + server + '/';\r\n\r\n        var socketIOScript = document.createElement('script');\r\n        socketIOScript.setAttribute('src', this.gameServerUrl + 'socket.io/socket.io.js');\r\n        document.head.appendChild(socketIOScript);\r\n\r\n        this.SocketIOCheck();\r\n    }\r\n\r\n    SocketIOCheck(){\r\n        if(typeof io == 'undefined'){\r\n            this.currentConnectionTimeout++;\r\n\r\n            this.currentConnectionTimeout == this.connectionTimeout\r\n                ? this.Send('SocketConnectionTimeout')\r\n                : setTimeout(this.SocketIOCheck.bind(this), 1000);\r\n\r\n            return;\r\n        }\r\n\r\n        this.ConnectToGameServer();\r\n    }\r\n\r\n    ConnectToGameServer(){\r\n        this.currentConnectionTimeout = 0;\r\n\r\n        this.socket = io.connect(this.gameServerUrl);\r\n\r\n        this.socket.on('connect', this.OnConnected.bind(this));\r\n        this.socket.on('disconnect', this.OnDisconnected.bind(this));\r\n    }\r\n\r\n    JoinLobby(){\r\n        this.roomSocket = io.connect(this.gameServerUrl + 'rooms');\r\n        this.roomSocket.on('connect', this.OnConnectedToRoom.bind(this));\r\n\r\n        this.roomSocket.on('get-room-list', this.GetRoomList.bind(this));\r\n        this.roomSocket.on('get-player-list', this.GetPlayerList.bind(this));\r\n        this.roomSocket.on('start-game', this.OnGameStarted.bind(this));\r\n        this.roomSocket.on('room-is-ready', this.OnRoomReady.bind(this));\r\n    }\r\n\r\n    CreateRoom(roomName){\r\n        this.roomSocket.emit('create-room', { roomName: roomName }, this.OnRoomCreated.bind(this));\r\n    }\r\n\r\n    OnRoomCreated(data){\r\n        this.Send('SocketRoomCreated', JSON.stringify(data));\r\n    }\r\n\r\n    JoinRoom(roomID){\r\n        this.roomSocket.emit('join-room', { roomID: roomID }, this.OnRoomJoined.bind(this));\r\n    }\r\n\r\n    OnRoomJoined(data){\r\n        this.Send('SocketRoomJoined', JSON.stringify(data));\r\n    }\r\n\r\n    LeaveRoom(roomID){\r\n        this.roomSocket.emit('leave-room', { roomID: roomID }, this.OnLeftRoom.bind(this));\r\n    }\r\n\r\n    OnLeftRoom(){\r\n        this.Send('SocketLeftRoom');\r\n    }\r\n\r\n    GetRoomList(){\r\n        this.roomSocket.emit('get-room-list', this.OnGotRoomList.bind(this));\r\n    }\r\n\r\n    OnGotRoomList(data){\r\n        this.Send('SocketGotRoomList', JSON.stringify(data));\r\n    }\r\n\r\n    GetPlayerList(roomID){\r\n        this.roomSocket.emit('get-player-list', { roomID: roomID }, this.OnGotPlayerList.bind(this));\r\n    }\r\n\r\n    OnGotPlayerList(data){\r\n        this.Send('SocketGotPlayerList', JSON.stringify(data));\r\n    }\r\n\r\n    UpdatePlayer(data){\r\n        this.roomSocket.emit('update-player', { updateData: data });\r\n    }\r\n\r\n    OnRoomReady(){\r\n        this.Send('SocketRoomReady');\r\n    }\r\n\r\n    StartGame(roomID){\r\n        this.roomID = roomID;\r\n        this.roomSocket.emit('start-game', { roomID: roomID}, this.OnGameStarted.bind(this));\r\n    }\r\n\r\n    OnGameStarted(){\r\n        this.gameClient.StartReceiver({\r\n            socket: this.roomSocket,\r\n            roomID: this.roomID\r\n        });\r\n\r\n        this.Send('SocketStartedGame');\r\n    }\r\n\r\n    OnConnected(){\r\n        this.socket.emit('set-config', { config: this.config });\r\n        this.socket.emit('get-connection-id', this.OnGotConnectionID.bind(this));\r\n    }\r\n\r\n    OnGotConnectionID(connectionID){\r\n        this.connectionID = connectionID;\r\n        this.JoinLobby();\r\n    }\r\n\r\n    OnDisconnected(){\r\n        this.roomID = null;\r\n        this.Send('SocketDisconnected');\r\n    }\r\n\r\n    OnConnectedToRoom(){\r\n        this.Send('SocketConnected', this.connectionID);\r\n    }\r\n\r\n}\r\n\r\nexport default WebSocketLobby;","import WebSocketLobby from './WebSocketLobby/WebSocketLobby.js';\r\nimport MyGameClient from './Game/MyGameClient.js';\r\n\r\n\r\nwindow.webglSocketLobby = new WebSocketLobby(new MyGameClient());\r\n\r\n"]}